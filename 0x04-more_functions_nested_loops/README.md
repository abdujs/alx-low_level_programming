more nested loops and more function
